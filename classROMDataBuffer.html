<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BackgroundAudio: ROMDataBuffer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">BackgroundAudio<span id="projectnumber">&#160;1.3.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classROMDataBuffer-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ROMDataBuffer Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Special-purpose buffer which never shifts memory and only allows a single written block of data, used for ROM sources.  
 <a href="classROMDataBuffer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="BackgroundAudioBuffers_8h_source.html">BackgroundAudioBuffers.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac8cdfd114eb31e8d9b9ae3ce8c643162" id="r_ac8cdfd114eb31e8d9b9ae3ce8c643162"><td class="memItemLeft" align="right" valign="top">const uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMDataBuffer.html#ac8cdfd114eb31e8d9b9ae3ce8c643162">buffer</a> ()</td></tr>
<tr class="memdesc:ac8cdfd114eb31e8d9b9ae3ce8c643162"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get access to internal buffer pointer (avoiding memcpy)  <br /></td></tr>
<tr class="separator:ac8cdfd114eb31e8d9b9ae3ce8c643162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad99cc27809daac093ad37884d054c2c6" id="r_ad99cc27809daac093ad37884d054c2c6"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMDataBuffer.html#ad99cc27809daac093ad37884d054c2c6">available</a> ()</td></tr>
<tr class="memdesc:ad99cc27809daac093ad37884d054c2c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine number of bytes that can be read.  <br /></td></tr>
<tr class="separator:ad99cc27809daac093ad37884d054c2c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f441084ba791aff7a094640517ebed" id="r_a29f441084ba791aff7a094640517ebed"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMDataBuffer.html#a29f441084ba791aff7a094640517ebed">availableForWrite</a> ()</td></tr>
<tr class="memdesc:a29f441084ba791aff7a094640517ebed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine how much unused space is available in the buffer.  <br /></td></tr>
<tr class="separator:a29f441084ba791aff7a094640517ebed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a462860823893d98ca9ba67b63dc72d2a" id="r_a462860823893d98ca9ba67b63dc72d2a"><td class="memItemLeft" align="right" valign="top">constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMDataBuffer.html#a462860823893d98ca9ba67b63dc72d2a">size</a> ()</td></tr>
<tr class="memdesc:a462860823893d98ca9ba67b63dc72d2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total size of the statically allocated buffer.  <br /></td></tr>
<tr class="separator:a462860823893d98ca9ba67b63dc72d2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef9f9ca11566ea52711c53896c75174" id="r_a6ef9f9ca11566ea52711c53896c75174"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMDataBuffer.html#a6ef9f9ca11566ea52711c53896c75174">write</a> (const uint8_t *data, size_t cnt)</td></tr>
<tr class="memdesc:a6ef9f9ca11566ea52711c53896c75174"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a <em>pointer</em> to a block of memory into the buffer, replacing any existing data.  <br /></td></tr>
<tr class="separator:a6ef9f9ca11566ea52711c53896c75174"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4313125c1ca5a12a3da6dab25bf42b1d" id="r_a4313125c1ca5a12a3da6dab25bf42b1d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMDataBuffer.html#a4313125c1ca5a12a3da6dab25bf42b1d">write0</a> (size_t cnt)</td></tr>
<tr class="memdesc:a4313125c1ca5a12a3da6dab25bf42b1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">0-fill a portion of the buffer, but will fail because there is no buffer here  <br /></td></tr>
<tr class="separator:a4313125c1ca5a12a3da6dab25bf42b1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c86b5455f25e891ea6e3e4c60899875" id="r_a0c86b5455f25e891ea6e3e4c60899875"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classROMDataBuffer.html#a0c86b5455f25e891ea6e3e4c60899875">shiftUp</a> (size_t cnt)</td></tr>
<tr class="memdesc:a0c86b5455f25e891ea6e3e4c60899875"><td class="mdescLeft">&#160;</td><td class="mdescRight">Invalidate a portion of buffer and shift remaining data up.  <br /></td></tr>
<tr class="separator:a0c86b5455f25e891ea6e3e4c60899875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67609cdde7809d9ac7e25488e20bb405" id="r_a67609cdde7809d9ac7e25488e20bb405"><td class="memItemLeft" align="right" valign="top"><a id="a67609cdde7809d9ac7e25488e20bb405" name="a67609cdde7809d9ac7e25488e20bb405"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>flush</b> ()</td></tr>
<tr class="memdesc:a67609cdde7809d9ac7e25488e20bb405"><td class="mdescLeft">&#160;</td><td class="mdescRight">Throw away (flush) the input buffer. <br /></td></tr>
<tr class="separator:a67609cdde7809d9ac7e25488e20bb405"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Special-purpose buffer which never shifts memory and only allows a single written block of data, used for ROM sources. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ad99cc27809daac093ad37884d054c2c6" name="ad99cc27809daac093ad37884d054c2c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad99cc27809daac093ad37884d054c2c6">&#9670;&#160;</a></span>available()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t ROMDataBuffer::available </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine number of bytes that can be read. </p>
<dl class="section return"><dt>Returns</dt><dd>Available bytes </dd></dl>

</div>
</div>
<a id="a29f441084ba791aff7a094640517ebed" name="a29f441084ba791aff7a094640517ebed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29f441084ba791aff7a094640517ebed">&#9670;&#160;</a></span>availableForWrite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t ROMDataBuffer::availableForWrite </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine how much unused space is available in the buffer. </p>
<dl class="section return"><dt>Returns</dt><dd>0 because this buffer can never really be written (but <code>write</code> does work) </dd></dl>

</div>
</div>
<a id="ac8cdfd114eb31e8d9b9ae3ce8c643162" name="ac8cdfd114eb31e8d9b9ae3ce8c643162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8cdfd114eb31e8d9b9ae3ce8c643162">&#9670;&#160;</a></span>buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t * ROMDataBuffer::buffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get access to internal buffer pointer (avoiding memcpy) </p>
<dl class="section return"><dt>Returns</dt><dd>Buffer pointer </dd></dl>

</div>
</div>
<a id="a0c86b5455f25e891ea6e3e4c60899875" name="a0c86b5455f25e891ea6e3e4c60899875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c86b5455f25e891ea6e3e4c60899875">&#9670;&#160;</a></span>shiftUp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ROMDataBuffer::shiftUp </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>cnt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Invalidate a portion of buffer and shift remaining data up. </p>
<p>Decoders need to be able to read an entier frame's worth of raw data from a contiguous memory region. They all operate by using the internal buffer pointer plus an offset, which they track, to avoid having to shift old data out every single frame (i.e. avoiding <code>memcpy</code>s). When they have accumulated enough of a virtual shift in their reading, they call <code>shiftUp</code> to actually do the memory copy and invalidate that old portion of the buffer.</p>
<p>Because this is a ROM image, we don't actually have to <code>memcpy</code> and just adjust the internal pointer.</p>
<p>In general decoders want to call this function ad <em>infrequently</em> as possible. </p>

</div>
</div>
<a id="a462860823893d98ca9ba67b63dc72d2a" name="a462860823893d98ca9ba67b63dc72d2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a462860823893d98ca9ba67b63dc72d2a">&#9670;&#160;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t ROMDataBuffer::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get total size of the statically allocated buffer. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes in total </dd></dl>

</div>
</div>
<a id="a6ef9f9ca11566ea52711c53896c75174" name="a6ef9f9ca11566ea52711c53896c75174"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ef9f9ca11566ea52711c53896c75174">&#9670;&#160;</a></span>write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t ROMDataBuffer::write </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>cnt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy a <em>pointer</em> to a block of memory into the buffer, replacing any existing data. </p>
<p>This differs from <code><a class="el" href="classRawDataBuffer.html" title="Interrupt-safe, multicore-safe biftable buffer for libmad raw data.">RawDataBuffer</a></code> in that no data is actually copied and there is no local buffer. Only the pointer to the ROM data and its size is captured here. The same <code><a class="el" href="classROMDataBuffer.html" title="Special-purpose buffer which never shifts memory and only allows a single written block of data,...">ROMDataBuffer</a></code> can have <code>write</code> called multiple times as long as all the existing data is already emptied by the decoder or cleared using <code>flush</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Raw data bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cnt</td><td>Number of bytes to write</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes actually written </dd></dl>

</div>
</div>
<a id="a4313125c1ca5a12a3da6dab25bf42b1d" name="a4313125c1ca5a12a3da6dab25bf42b1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4313125c1ca5a12a3da6dab25bf42b1d">&#9670;&#160;</a></span>write0()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t ROMDataBuffer::write0 </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>cnt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>0-fill a portion of the buffer, but will fail because there is no buffer here </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cnt</td><td>Number of 0 bytes to write</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 due to unsupported </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="BackgroundAudioBuffers_8h_source.html">BackgroundAudioBuffers.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
